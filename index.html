<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Skins & Keys Shop</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f4f4f4; transition: background 0.3s, color 0.3s; color: #333; }
        body.dark { background: #333; color: #fff; }
        header { text-align: center; background: #333; color: white; padding: 20px; }
        nav { background: #222; color: white; padding: 10px; text-align: center; }
        nav a { color: white; margin: 0 15px; text-decoration: none; }
        .products { display: flex; flex-wrap: wrap; justify-content: center; }
        .product { background: white; border: 1px solid #ddd; margin: 10px; padding: 15px; width: 250px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .product:hover { transform: scale(1.05); }
        .product.low-stock { border-color: red; }
        .product img { max-width: 100%; height: 150px; }
        button { background: #4CAF50; color: white; border: none; padding: 10px 15px; cursor: pointer; margin: 5px; }
        button:hover { background: #45a049; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        #cart { position: fixed; top: 10px; right: 10px; background: white; padding: 10px; border: 1px solid #ddd; max-width: 200px; max-height: 300px; overflow-y: auto; }
        .review { margin: 10px 0; border-top: 1px solid #eee; padding-top: 10px; }
        .rating { color: gold; }
        .search { text-align: center; margin: 20px 0; }
        .admin { display: none; background: #fff; padding: 20px; border: 1px solid #ddd; margin: 20px; }
        .user-panel { position: fixed; top: 10px; left: 10px; background: white; padding: 10px; border: 1px solid #ddd; }
        .notification { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #4CAF50; color: white; padding: 10px; display: none; z-index: 1000; border-radius: 5px; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1001; }
        .modal-content { background: white; padding: 20px; border-radius: 5px; max-width: 500px; }
        .order-history, .wishlist { display: none; background: white; padding: 20px; border: 1px solid #ddd; margin: 20px; }
        .social-share { margin: 10px 0; }
        .promo { text-align: center; margin: 20px 0; }
        footer { text-align: center; padding: 20px; background: #333; color: white; margin-top: 20px; }
        @media (max-width: 600px) { .product { width: 100%; } }
    </style>
</head>
<body>
    <header>
        <h1 id="title">Minecraft Skins & Keys Shop</h1>
        <p id="subtitle">Buy custom skins, game keys, and more!</p>
        <button id="lang-toggle" aria-label="Toggle Language">Español</button>
        <button id="dark-mode-toggle" aria-label="Toggle Dark Mode">Dark Mode</button>
    </header>

    <nav>
        <a href="#home" aria-label="Home">Home</a>
        <a href="#products" aria-label="Products">Products</a>
        <a href="#about" aria-label="About">About</a>
        <a href="#contact" aria-label="Contact">Contact</a>
        <a href="#" id="history-link" aria-label="Order History">Order History</a>
    </nav>

    <div class="user-panel">
        <button id="login-btn" aria-label="Login">Login</button>
        <button id="signup-btn" aria-label="Sign Up">Sign Up</button>
        <div id="user-info" style="display:none;">Welcome, <span id="username"></span>! <button id="logout-btn" aria-label="Logout">Logout</button></div>
        <button id="admin-toggle" style="display:none;" aria-label="Admin Panel">Admin Panel</button>
    </div>

    <div id="admin-panel" class="admin">
        <h3>Admin: Add Product</h3>
        <input type="text" id="new-name" placeholder="Product Name" aria-label="Product Name">
        <input type="number" id="new-price" placeholder="Price" aria-label="Price">
        <input type="text" id="new-img" placeholder="Image URL" aria-label="Image URL">
        <select id="new-category" aria-label="Category">
            <option value="skins">Skins</option>
            <option value="keys">Keys</option>
            <option value="addons">Add-ons</option>
            <option value="bundles">Bundles</option>
        </select>
        <input type="number" id="new-stock" placeholder="Stock" value="10" aria-label="Stock">
        <button id="add-product" aria-label="Add Product">Add</button>
    </div>

    <div class="search">
        <input type="text" id="search" placeholder="Search products..." aria-label="Search Products">
        <select id="filter" aria-label="Filter Products">
            <option value="all">All</option>
            <option value="skins">Skins</option>
            <option value="keys">Keys</option>
            <option value="addons">Add-ons</option>
            <option value="bundles">Bundles</option>
        </select>
    </div>

    <div class="promo">
        <input type="text" id="promo-code" placeholder="Promo Code" aria-label="Promo Code">
        <button id="apply-promo" aria-label="Apply Promo">Apply</button>
        <span id="promo-msg" aria-live="polite"></span>
    </div>

    <div id="cart">
        <h3>Cart: <span id="cart-count">0</span> items</h3>
        <ul id="cart-items"></ul>
        <p>Total: $<span id="cart-total">0</span></p>
        <button id="checkout" aria-label="Checkout">Checkout</button>
        <button id="wishlist-btn" aria-label="View Wishlist">View Wishlist</button>
    </div>

    <div id="wishlist" class="modal">
        <div class="modal-content">
            <h3>Wishlist</h3>
            <ul id="wishlist-items"></ul>
            <button onclick="closeModal('wishlist')" aria-label="Close Wishlist">Close</button>
        </div>
    </div>

    <div id="order-history" class="modal">
        <div class="modal-content">
            <h3>Your Order History</h3>
            <ul id="history-list"></ul>
            <button onclick="closeModal('order-history')" aria-label="Close History">Close</button>
        </div>
    </div>

    <div class="products" id="product-list">
        <!-- Products loaded dynamically -->
    </div>

    <div class="notification" id="notification" aria-live="assertive"></div>

    <footer>
        <p>&copy; 2023 Minecraft Shop. <a href="#" aria-label="Terms">Terms</a> | <a href="#" aria-label="Privacy">Privacy</a> | <a href="#" aria-label="Refund Policy">Refund Policy</a></p>
        <input type="email" id="newsletter" placeholder="Subscribe to newsletter" aria-label="Newsletter Email">
        <button id="subscribe" aria-label="Subscribe">Subscribe</button>
        <div class="social-share">
            <button onclick="shareOnTwitter()" aria-label="Share on Twitter">Share on Twitter</button>
            <button onclick="shareOnFacebook()" aria-label="Share on Facebook">Share on Facebook</button>
        </div>
    </footer>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Translations
        const translations = {
            en: { title: 'Minecraft Skins & Keys Shop', subtitle: 'Buy custom skins, game keys, and more!', login: 'Login', signup: 'Sign Up', search: 'Search products...', all: 'All', skins: 'Skins', keys: 'Keys', addons: 'Add-ons', bundles: 'Bundles', cart: 'Cart', checkout: 'Checkout', wishlist: 'View Wishlist', history: 'Order History', promo: 'Promo Code', apply: 'Apply', subscribe: 'Subscribe' },
            es: { title: 'Tienda de Skins y Claves de Minecraft', subtitle: '¡Compra skins personalizadas, claves de juegos y más!', login: 'Iniciar Sesión', signup: 'Registrarse', search: 'Buscar productos...', all: 'Todos', skins: 'Skins', keys: 'Claves', addons: 'Complementos', bundles: 'Paquetes', cart: 'Carrito', checkout: 'Pagar', wishlist: 'Ver Lista de Deseos', history: 'Historial de Pedidos', promo: 'Código Promocional', apply: 'Aplicar', subscribe: 'Suscribirse' }
        };
        let lang = 'en';

        // Sample products with stock
        let products = [
            { id: 1, name: 'Custom Skin Pack', price: 5, img: 'https://via.placeholder.com/200x150?text=Custom+Skin', category: 'skins', stock: 10, reviews: [{ user: 'Player1', rating: 5, comment: 'Awesome!' }] },
            { id: 2, name: 'Minecraft Java Key', price: 10, img: 'https://via.placeholder.com/200x150?text=Minecraft+Key', category: 'keys', stock: 5, reviews: [] },
            { id: 3, name: 'Skin + Key Bundle', price: 12, img: 'https://via.placeholder.com/200x150?text=Bundle', category: 'bundles', stock: 8, reviews: [] },
            { id: 4, name: 'Texture Pack Add-on', price: 3, img: 'https://via.placeholder.com/200x150?text=Texture+Pack', category: 'addons', stock: 15, reviews: [] },
            { id: 5, name: 'Redstone Mod Bundle', price: 8, img: 'https://via.placeholder.com/200x150?text=Mod+Bundle', category: 'bundles', stock: 3, reviews: [] }
        ];
        let cart = [];
        let wishlist = [];
        let orderHistory = JSON.parse(localStorage.getItem('orderHistory')) || [];
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let currentUser = null;
        let discount = 0;
        let analytics = { views: 0, purchases: 0, shares: 0 }; // Simulate analytics

        // Load products
        function loadProducts(filter = 'all', search = '') {
            const list = document.getElementById('product-list');
            list.innerHTML = '';
            products.filter(p => (filter === 'all' || p.category === filter) && p.name.toLowerCase().includes(search.toLowerCase())).forEach(p => {
                const div = document.createElement('div');
                div.className = `product ${p.stock < 5 ? 'low-stock' : ''}`;
                div.innerHTML = `
                    <img src="${p.img}" alt="${p.name}">
                    <h3>${p.name}</h3>
                    <p>$${p.price} (Stock: ${p.stock})</p>
                    <button onclick="addToCart(${p.id})" ${p.stock <= 0 ? 'disabled' : ''} aria-label="Add ${p.name} to Cart">Add to Cart</button>
                    <button onclick="addToWishlist(${p.id})" aria-label="Add ${p.name} to Wishlist">Add to Wishlist</button>
                    <div class="social-share">
                        <button onclick="shareProduct('${p.name}')" aria-label="Share ${p.name}">Share</button>
                    </div>
                    <div class="reviews">
                        ${p.reviews.map(r => `<div class="review"><span class="rating">${'★'.repeat(r.rating)}</span> ${r.comment} - ${r.user}</div>`).join('')}
                    </div>
                    <input type="text" placeholder="Add review" id="review-${p.id}" aria-label="Review for ${p.name}">
                    <button onclick="addReview(${p.id})" aria-label="Submit Review">Submit Review</button>
                `;
                list.appendChild(div);
            });
            analytics.views++;
        }
        loadProducts();

        // Cart functions
        function addToCart(id) {
            const product = products.find(p => p.id === id);
            if (product.stock > 0) {
                cart.push(product);
                product.stock--;
                updateCart();
                showNotification('Added to cart!');
                if (product.stock < 5) showNotification('Low stock alert!');
            }
        }
        function updateCart() {
            document.getElementById('cart-count').textContent = cart.length;
            const items = document.getElementById('cart-items');
            items.innerHTML = cart.map(item => `<li>${item.name} - $${item.price}</li>`).join('');
            const total = cart.reduce((sum, item) => sum + item.price, 0) * (1 - discount / 100);
            document.getElementById('cart-total').textContent = total.toFixed(2);
        }

        // Wishlist
        function addToWishlist(id) { if (!wishlist.find(p => p.id === id)) { wishlist.push(products.find(p => p.id === id)); showNotification('Added to wishlist!'); } }
        document.getElementById('wishlist-btn').addEventListener('click', () => openModal('wishlist'));

        // Reviews
        function addReview(id) {
            if (!currentUser) return showNotification('Login to review!');
            const input = document.getElementById(`review-${id}`);
            products.find(p => p.id === id).reviews.push({ user: currentUser, rating: 5, comment: input.value });
            input.value = '';
            loadProducts();
        }

        // User auth
        document.getElementById('login-btn').addEventListener('click', () => {
            const user = prompt('Username:');
            if (users.includes(user)) { currentUser = user; updateUserUI(); }
        });
        document.getElementById('signup-btn').addEventListener('click', () => {
            const user = prompt('New Username:');
            if (!users.includes(user)) { users.push(user); localStorage.setItem('users', JSON.stringify(users)); currentUser = user; updateUserUI(); }
        });
        document.getElementById('logout-btn').addEventListener('click', () => { currentUser = null; updateUserUI(); });
        function updateUserUI() {
            const info = document.getElementById('user-info');
            const login = document.getElementById('login-btn');
            const signup = document.getElementById('signup-btn');
            if (currentUser) {
                info.style.display = 'block'; login.style.display = 'none'; signup.style.display = 'none';
                document.getElementById('username').textContent = currentUser;
                if (currentUser === 'admin') document.getElementById('admin-toggle').style.display = 'inline';
            } else {
                info.style.display = 'none'; login.style.display = 'inline'; signup.style.display = 'inline';
                document.getElementById('admin-toggle').style.display = 'none';